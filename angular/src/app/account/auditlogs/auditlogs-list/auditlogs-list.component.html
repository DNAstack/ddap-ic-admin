<ddaplib-header iconClass="icon icon-rules" [label]="getDisplayName()"></ddaplib-header>
<ddaplib-main>
  <div>
    <mat-form-field>
      <mat-chip-list #searchList
                     [formControl]="searchTextList">
        <mat-chip *ngFor="let search of searchTextList.value"
                  (removed)="removeSearchText(search)"
                  [removable]="true">
          {{search}}
          <mat-icon matChipRemove>cancel</mat-icon>
        </mat-chip>
        <input placeholder="Search by text"
               [matChipInputFor]="searchList"
               [matChipInputSeparatorKeyCodes]="separatorCodes"
               (matChipInputTokenEnd)="searchByText($event)" />
      </mat-chip-list>
    </mat-form-field>
  </div>
  <div class="filters">
    <mat-form-field>
      <mat-label>Log type</mat-label>
      <mat-select [formControl]="logType"
                  (selectionChange)="searchLogs()"
                  data-se="log-type">
        <mat-option [value]="logTypes.all">ALL</mat-option>
        <mat-option [value]="logTypes.request">REQUEST</mat-option>
        <mat-option [value]="logTypes.policy">POLICY</mat-option>
      </mat-select>
    </mat-form-field>
    <mat-form-field>
      <mat-label>Logs per page</mat-label>
      <mat-select [formControl]="pageSize"
                  (selectionChange)="searchLogs()"
                  data-se="page-size">
        <mat-option *ngFor="let page of ['10', '20', '30', '40', '50']"
                    [value]="page">
          {{page}}
        </mat-option>
      </mat-select>
    </mat-form-field>
  </div>
  <table mat-table [dataSource]="auditLogs$ | async"
         data-se="auditlog-result"
         class="table--base mat-elevation-z1">
    <ng-container matColumnDef="auditlogId">
      <th mat-header-cell *matHeaderCellDef>Auditlog</th>
      <td mat-cell *matCellDef="let log"
          data-se="auditlog-id"
          (click)="gotoAuditlogDetail(log)"
          class="table--link">
        {{log['auditlogId']}}
      </td>
    </ng-container>
    <ng-container matColumnDef="type">
      <th mat-header-cell *matHeaderCellDef> Log Type </th>
      <td mat-cell *matCellDef="let log"
          data-se="log-type-cell"
          class="table--link">
        {{log['type']}}
      </td>
    </ng-container>
    <ng-container matColumnDef="decision">
      <th mat-header-cell *matHeaderCellDef> Decision </th>
      <td mat-cell *matCellDef="let log"
          class="table--link">
        {{log['decision']}}
      </td>
    </ng-container>
    <ng-container matColumnDef="time">
      <th mat-header-cell *matHeaderCellDef> Time </th>
      <td mat-cell *matCellDef="let log"
          class="table--link">
        {{log['time']}}
      </td>
    </ng-container>
    <ng-container matColumnDef="resourceName">
      <th mat-header-cell *matHeaderCellDef> Resource Name </th>
      <td mat-cell *matCellDef="let log"
          class="table--link">
        {{log['resourceName']}}
      </td>
    </ng-container>
    <tr mat-header-row *matHeaderRowDef="columnsToDisplay"></tr>
    <tr mat-row
        *matRowDef="let log; columns: columnsToDisplay">
    </tr>
  </table>
</ddaplib-main>
